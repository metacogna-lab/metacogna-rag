name = "metacogna"
main = "src/index.ts"
compatibility_date = "2024-01-01"
compatibility_flags = ["nodejs_compat"]

routes = [
  { pattern = "api.metacogna.ai/*", zone_name = "metacogna.ai" }
]


# --- AI BINDING ---
[ai]
binding = "AI"

# --- VECTOR DATABASE ---
[[vectorize]]
binding = "VECTORIZE"
index_name = "metacogna-index"

# --- D1 DATABASE ---
[[d1_databases]]
binding = "DB"
database_name = "metacogna-db"
database_id = "75e3fd65-a847-4467-8fde-ea1722564167"

# --- R2 BUCKET ---
[[r2_buckets]]
binding = "metacogna_vault"
bucket_name = "metacogna-vault"

# --- ENVIRONMENT VARIABLES ---
# Public variables (non-sensitive)
[vars]
#LANGFUSE_HOST = "https://cloud.langfuse.com"
OPENAI_API_BASE = "https://openrouter.ai/api/v1"
ENVIRONMENT = "production"
SERVICE_NAME = "metacogna"
API_BASE_URL = "https://web.metacogna.ai"

# --- SECRETS (Set via: wrangler secret put <NAME>) ---
# These should be set as secrets, not in this file:
# GEMINI_API_KEY - Google Gemini API key (optional, for Google provider)
# OPENAI_API_KEY - OpenAI API key (optional, for OpenAI provider)
# ANTHROPIC_API_KEY - Anthropic API key (optional, for Anthropic provider)
# LANGFUSE_PUBLIC_KEY - Langfuse public key (optional)
# LANGFUSE_SECRET_KEY - Langfuse secret key (optional)


# ---- OBSERVABILITY (DEBUG) ---- #
[observability]
[observability.logs]
enabled = true
head_sampling_rate = 1
invocation_logs = true
persist = true
level = "debug"

[observability.traces]
enabled = true
persist = true
head_sampling_rate = 1
sampling_rate = 1

